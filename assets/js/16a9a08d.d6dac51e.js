(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{128:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return m}));var r=n(0),l=n.n(r);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t){if(null==e)return{};var n,r,l=function(e,t){if(null==e)return{};var n,r,l={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var u=l.a.createContext({}),s=function(e){var t=l.a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=s(e.components);return l.a.createElement(u.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return l.a.createElement(l.a.Fragment,{},t)}},p=l.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,i=e.parentName,u=d(e,["components","mdxType","originalType","parentName"]),c=s(n),p=r,m=c["".concat(i,".").concat(p)]||c[p]||b[p]||a;return n?l.a.createElement(m,o(o({ref:t},u),{},{components:n})):l.a.createElement(m,o({ref:t},u))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=p;var o={};for(var d in t)hasOwnProperty.call(t,d)&&(o[d]=t[d]);o.originalType=e,o.mdxType="string"==typeof e?e:r,i[1]=o;for(var u=2;u<a;u++)i[u]=n[u];return l.a.createElement.apply(null,i)}return l.a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},75:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return o})),n.d(t,"toc",(function(){return d})),n.d(t,"default",(function(){return s}));var r=n(3),l=n(7),a=(n(0),n(128)),i={id:"enterprise-helm",title:"Enterprise Helm Charts",sidebar_label:"Enterprise Helm Charts"},o={unversionedId:"enterprise-helm",id:"enterprise-helm",isDocsHomePage:!1,title:"Enterprise Helm Charts",description:"If you run or have access to a Kubernetes cluster and are comfortable with Helm, we maintain official BuildBuddy Helm charts that are easy to configure and deploy.",source:"@site/../docs/enterprise-helm.md",slug:"/enterprise-helm",permalink:"/docs/enterprise-helm",editUrl:"https://github.com/buildbuddy-io/buildbuddy/edit/master/docs/../docs/enterprise-helm.md",version:"current",sidebar_label:"Enterprise Helm Charts",sidebar:"someSidebar",previous:{title:"Configuring BuildBuddy Enterprise",permalink:"/docs/enterprise-config"},next:{title:"Enterprise RBE Setup",permalink:"/docs/enterprise-rbe"}},d=[{value:"TL;DR",id:"tldr",children:[]},{value:"Prerequisites",id:"prerequisites",children:[]},{value:"Installing the repo",id:"installing-the-repo",children:[]},{value:"Installing the Chart",id:"installing-the-chart",children:[]},{value:"Uninstalling the Chart",id:"uninstalling-the-chart",children:[]},{value:"Updating your release",id:"updating-your-release",children:[]},{value:"Writing deployment to a file",id:"writing-deployment-to-a-file",children:[{value:"Example configurations",id:"example-configurations",children:[]},{value:"Example MySQL configuration",id:"example-mysql-configuration",children:[]},{value:"Example external database configuration",id:"example-external-database-configuration",children:[]},{value:"Example ingress and certs configuration",id:"example-ingress-and-certs-configuration",children:[]}]},{value:"Example with auth (required for enterprise features)",id:"example-with-auth-required-for-enterprise-features",children:[]},{value:"Example with remote build execution",id:"example-with-remote-build-execution",children:[]},{value:"More examples",id:"more-examples",children:[{value:"Local development",id:"local-development",children:[]}]},{value:"Learn more",id:"learn-more",children:[]}],u={toc:d};function s(e){var t=e.components,n=Object(l.a)(e,["components"]);return Object(a.b)("wrapper",Object(r.a)({},u,n,{components:t,mdxType:"MDXLayout"}),Object(a.b)("p",null,"If you run or have access to a Kubernetes cluster and are comfortable with ",Object(a.b)("a",{parentName:"p",href:"https://helm.sh/"},"Helm"),", we maintain official BuildBuddy Helm charts that are easy to configure and deploy."),Object(a.b)("p",null,"They have options to deploy everything necessary to use all of BuildBuddy's bells and whistles - including MySQL, nginx, remote build execution and more."),Object(a.b)("p",null,"The official BuildBuddy charts live in our ",Object(a.b)("a",{parentName:"p",href:"https://github.com/buildbuddy-io/buildbuddy-helm"},"buildbuddy-helm repo"),"."),Object(a.b)("h2",{id:"tldr"},"TL;DR"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"helm repo add buildbuddy https://helm.buildbuddy.io\nhelm install buildbuddy buildbuddy/buildbuddy-enterprise \\\n  --set mysql.mysqlUser=sampleUser \\\n  --set mysql.mysqlPassword=samplePassword\n")),Object(a.b)("h2",{id:"prerequisites"},"Prerequisites"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"Kubernetes 1.15+ with Beta APIs enabled"),Object(a.b)("li",{parentName:"ul"},"Helm v2/v3"),Object(a.b)("li",{parentName:"ul"},"Tiller (the Helm v2 server-side component) installed on the cluster")),Object(a.b)("h2",{id:"installing-the-repo"},"Installing the repo"),Object(a.b)("p",null,"To install the BuildBuddy Helm repo:"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"helm repo add buildbuddy https://helm.buildbuddy.io\n")),Object(a.b)("h2",{id:"installing-the-chart"},"Installing the Chart"),Object(a.b)("p",null,"To install the chart with the release name ",Object(a.b)("inlineCode",{parentName:"p"},"my-release"),":"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"$ helm install my-release buildbuddy/buildbuddy-enterprise\n")),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Helm v2 command")),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"$ helm install --name my-release buildbuddy/buildbuddy-enterprise\n")),Object(a.b)("p",null,"The command deploys BuildBuddy on the Kubernetes cluster in the default configuration. The ",Object(a.b)("a",{parentName:"p",href:"#configuration"},"configuration"),"\nsection lists the parameters that can be configured during installation."),Object(a.b)("h2",{id:"uninstalling-the-chart"},"Uninstalling the Chart"),Object(a.b)("p",null,"To uninstall/delete the ",Object(a.b)("inlineCode",{parentName:"p"},"my-release")," deployment:"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"$ helm delete my-release\n")),Object(a.b)("p",null,"The command removes all the Kubernetes components associated with the chart and deletes the release."),Object(a.b)("h2",{id:"updating-your-release"},"Updating your release"),Object(a.b)("p",null,"If you change configuration, you can update your deployment:"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"$ helm upgrade my-release -f my-values.yaml buildbuddy/buildbuddy-enterprise\n")),Object(a.b)("h2",{id:"writing-deployment-to-a-file"},"Writing deployment to a file"),Object(a.b)("p",null,"You can write your Kubernetes deployment configuration to a file with release name ",Object(a.b)("inlineCode",{parentName:"p"},"my-release"),":"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"$ helm template my-release buildbuddy/buildbuddy-enterprise > buildbuddy-deploy.yaml\n")),Object(a.b)("p",null,"You can then check this configuration in to your source repository, or manually apply it to your cluster with:"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"$ kubectl apply -f buildbuddy-deploy.yaml\n")),Object(a.b)("h3",{id:"example-configurations"},"Example configurations"),Object(a.b)("p",null,"Below are some examples of ",Object(a.b)("inlineCode",{parentName:"p"},".yaml")," files with values that could be passed to the ",Object(a.b)("inlineCode",{parentName:"p"},"helm"),"\ncommand with the ",Object(a.b)("inlineCode",{parentName:"p"},"-f")," or ",Object(a.b)("inlineCode",{parentName:"p"},"--values")," flag to get started."),Object(a.b)("h3",{id:"example-mysql-configuration"},"Example MySQL configuration"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},'mysql:\n  enabled: true\n  mysqlUser: "sampleUser"\n  mysqlPassword: "samplePassword"\n')),Object(a.b)("h3",{id:"example-external-database-configuration"},"Example external database configuration"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},'mysql:\n  enabled: false\n\nconfig:\n  database:\n    ## mysql:     "mysql://<USERNAME>:<PASSWORD>@tcp(<HOST>:3306)/<DATABASE_NAME>"\n    ## sqlite:    "sqlite3:///tmp/buildbuddy-enterprise.db"\n    data_source: "" # Either set this or mysql.enabled, not both!\n')),Object(a.b)("h3",{id:"example-ingress-and-certs-configuration"},"Example ingress and certs configuration"),Object(a.b)("p",null,"Note: make sure to run ",Object(a.b)("inlineCode",{parentName:"p"},"kubectl apply --validate=false -f https://github.com/jetstack/cert-manager/releases/download/v0.16.1/cert-manager.crds.yaml")," to install CRDs before deploying this configuration."),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},'ingress:\n  enabled: true\n  sslEnabled: true\n  httpHost: buildbuddy.example.com\n  grpcHost: buildbuddy-grpc.example.com\n\nmysql:\n  enabled: true\n  mysqlUser: "sampleUser"\n  mysqlPassword: "samplePassword"\n\ncertmanager:\n  enabled: true\n  emailAddress: your-email@gmail.com\n\nconfig:\n  app:\n    build_buddy_url: "https://buildbuddy.example.com"\n    events_api_url: "grpcs://buildbuddy-grpc.example.com"\n    cache_api_url: "grpcs://buildbuddy-grpc.example.com"\n  ssl:\n    enable_ssl: true\n')),Object(a.b)("h2",{id:"example-with-auth-required-for-enterprise-features"},"Example with auth (required for enterprise features)"),Object(a.b)("p",null,"Auth can be configured with any provider that supports OpenID Connect (OIDC) including Google GSuite, Okta, Auth0 and others."),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},'ingress:\n  enabled: true\n  sslEnabled: true\n  httpHost: buildbuddy.example.com\n  grpcHost: buildbuddy-grpc.example.com\n\nmysql:\n  enabled: true\n  mysqlUser: "sampleUser"\n  mysqlPassword: "samplePassword"\n\ncertmanager:\n  enabled: true\n  emailAddress: your-email@gmail.com\n\nconfig:\n  app:\n    build_buddy_url: "https://buildbuddy.example.com"\n    events_api_url: "grpcs://buildbuddy-grpc.example.com"\n    cache_api_url: "grpcs://buildbuddy-grpc.example.com"\n  auth:\n    ## To use Google auth, get client_id and client_secret here:\n    ## https://console.developers.google.com/apis/credentials\n    oauth_providers:\n      - issuer_url: "https://accounts.google.com" # OpenID Connect Discovery URL\n        client_id: "MY_CLIENT_ID"\n        client_secret: "MY_CLIENT_SECRET"\n  ssl:\n    enable_ssl: true\n')),Object(a.b)("h2",{id:"example-with-remote-build-execution"},"Example with remote build execution"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"executor:\n  enabled: true\n  replicas: 3\nredis:\n  enabled: true\nconfig:\n  remote_execution:\n    enable_remote_exec: true\n")),Object(a.b)("h2",{id:"more-examples"},"More examples"),Object(a.b)("p",null,"For more example ",Object(a.b)("inlineCode",{parentName:"p"},"config:")," blocks, see our ",Object(a.b)("a",{parentName:"p",href:"https://www.buildbuddy.io/docs/config#configuration-options"},"configuration docs"),"."),Object(a.b)("h3",{id:"local-development"},"Local development"),Object(a.b)("p",null,"For local testing use ",Object(a.b)("a",{parentName:"p",href:"https://github.com/kubernetes/minikube"},"minikube")),Object(a.b)("p",null,"Create local cluster using with specified Kubernetes version (e.g. ",Object(a.b)("inlineCode",{parentName:"p"},"1.15.6"),")"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"$ minikube start --kubernetes-version v1.15.6\n")),Object(a.b)("p",null,"Initialize helm"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"$ helm init\n")),Object(a.b)("p",null,"Above command is not required for Helm v3"),Object(a.b)("p",null,"Get dependencies"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"$ helm dependency update\n")),Object(a.b)("p",null,"Perform local installation"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"$ helm install . \\\n    --set image.tag=5.12.4 \\\n    --set mysql.mysqlUser=sampleUser \\\n    --set mysql.mysqlPassword=samplePassword\n")),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Helm v3 command")),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"$ helm install . \\\n    --generate-name \\\n    --set image.tag=5.12.4 \\\n    --set mysql.mysqlUser=sampleUser \\\n    --set mysql.mysqlPassword=samplePassword\n")),Object(a.b)("h2",{id:"learn-more"},"Learn more"),Object(a.b)("p",null,"For more information on configuring your BuildBuddy Enterprise Helm deploy, check out the chart:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",{parentName:"li",href:"https://github.com/buildbuddy-io/buildbuddy-helm/tree/master/charts/buildbuddy-enterprise"},"BuildBuddy Enterprise"))),Object(a.b)("p",null,"For more information on configuring BuildBuddy, see our ",Object(a.b)("a",{parentName:"p",href:"/docs/config"},"Configuration docs"),". If you have questions please don\u2019t hesitate to email us at ",Object(a.b)("a",{parentName:"p",href:"mailto:setup@buildbuddy.io"},"setup@buildbuddy.io")," or ping us on our ",Object(a.b)("a",{parentName:"p",href:"https://slack.buildbuddy.io"},"Slack channel"),"."))}s.isMDXComponent=!0}}]);