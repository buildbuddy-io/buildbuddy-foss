<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.71">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="BuildBuddy Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="BuildBuddy Blog Atom Feed"><title data-react-helmet="true">Workflows configuration | BuildBuddy</title><meta data-react-helmet="true" property="og:url" content="https://docs.buildbuddy.io/docs/workflows-config"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Workflows configuration | BuildBuddy"><meta data-react-helmet="true" name="description" content="This page provides documentation for buildbuddy.yaml, which can be placed"><meta data-react-helmet="true" property="og:description" content="This page provides documentation for buildbuddy.yaml, which can be placed"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon_black.svg"><link data-react-helmet="true" rel="canonical" href="https://docs.buildbuddy.io/docs/workflows-config"><link data-react-helmet="true" rel="alternate" href="https://docs.buildbuddy.io/docs/workflows-config" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.buildbuddy.io/docs/workflows-config" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.3d55f6d3.css">
<link rel="preload" href="/assets/js/styles.99ff62e2.js" as="script">
<link rel="preload" href="/assets/js/runtime~main.fb523e5f.js" as="script">
<link rel="preload" href="/assets/js/main.6a7acce9.js" as="script">
<link rel="preload" href="/assets/js/1.af4f1695.js" as="script">
<link rel="preload" href="/assets/js/2.188d4042.js" as="script">
<link rel="preload" href="/assets/js/3.98ab277b.js" as="script">
<link rel="preload" href="/assets/js/1be78505.31ec347f.js" as="script">
<link rel="preload" href="/assets/js/56.4a323b8d.js" as="script">
<link rel="preload" href="/assets/js/935f2afb.52920a53.js" as="script">
<link rel="preload" href="/assets/js/17896441.47f4e99e.js" as="script">
<link rel="preload" href="/assets/js/95212d9b.0b4173f1.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://www.buildbuddy.io" target="_self" rel="noopener noreferrer" class="navbar__brand"><img src="/img/logo.svg" alt="BuildBuddy Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo_white.svg" alt="BuildBuddy Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a><a href="https://docs.buildbuddy.io/docs/introduction/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Docs</a><a href="https://buildbuddy.io/faq" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">FAQs</a><a href="https://github.com/buildbuddy-io/buildbuddy" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><a href="https://buildbuddy.io/pricing" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">Pricing</a><a href="https://app.buildbuddy.io/" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">Login</a></div><div class="navbar__items navbar__items--right"><a href="https://app.buildbuddy.io/" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link" class="sign-up">Sign Up</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_GrZ2"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT"> </span></div><div class="react-toggle-track-x"><span class="toggle_71bT"> </span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a href="https://www.buildbuddy.io" target="_self" rel="noopener noreferrer" class="navbar__brand"><img src="/img/logo.svg" alt="BuildBuddy Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo_white.svg" alt="BuildBuddy Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://docs.buildbuddy.io/docs/introduction/" target="_blank" rel="noopener noreferrer" class="menu__link">Docs</a></li><li class="menu__list-item"><a href="https://buildbuddy.io/faq" target="_self" rel="noopener noreferrer" class="menu__link">FAQs</a></li><li class="menu__list-item"><a href="https://github.com/buildbuddy-io/buildbuddy" target="_self" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a href="https://buildbuddy.io/pricing" target="_self" rel="noopener noreferrer" class="menu__link">Pricing</a></li><li class="menu__list-item"><a href="https://app.buildbuddy.io/" target="_self" rel="noopener noreferrer" class="menu__link">Login</a></li><li class="menu__list-item"><a href="https://app.buildbuddy.io/" target="_self" rel="noopener noreferrer" class="menu__link" class="sign-up">Sign Up</a></li></ul></div></div></div></nav><div class="main-wrapper main-docs-wrapper"><div class="docPage_31aa"><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Workflows configuration</h1></header><div class="markdown"><p>This page provides documentation for <code>buildbuddy.yaml</code>, which can be placed
at the root of your git repo to configure BuildBuddy workflow execution.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>The configuration in <code>buildbuddy.yaml</code> only takes effect after you
<a href="/docs/workflows-setup#enable-workflows-for-a-repo">enable workflows for the repo</a>.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="example-config"></a>Example config<a class="hash-link" href="#example-config" title="Direct link to heading">#</a></h2><p>You can copy this example config as a starting point for your own <code>buildbuddy.yaml</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">actions</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Test all targets&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">triggers</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">push</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">branches</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;main&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">pull_request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">branches</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;main&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">bazel_commands</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;test //... --build_metadata=ROLE=CI --bes_backend=grpcs://cloud.buildbuddy.io --bes_results_url=https://app.buildbuddy.io/invocation/&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This config is equivalent to the default config that we use if you do
not have a <code>buildbuddy.yaml</code>, with some exceptions:</p><ul><li>This example uses <code>&quot;main&quot;</code> for the branch name -- if you copy this config,
be sure to replace that with the name of your main branch. By default, we
run the above bazel command when any branch is pushed.</li><li>By default, we also pass <code>--remote_header=x-buildbuddy-api-key=&lt;YOUR_API_KEY&gt;</code>,
so that workflow builds show up in your BuildBuddy org. For security reasons,
we only do this if your repo is private.</li></ul><p>Other points to note:</p><ul><li>Remote cache and remote execution (RBE) require additional configuration.
The configuration steps are the same as when running Bazel locally.
See the <strong>Setup</strong> page in the BuildBuddy UI.</li><li>Bazel commands are run directly in your workspace, which means that your
<code>.bazelrc</code> is respected. If you have lots of flags, we recommend adding
them to your <code>.bazelrc</code> instead of adding them in this YAML config.</li><li>We run your commands with a <a href="https://github.com/bazelbuild/bazelisk" target="_blank" rel="noopener noreferrer">bazelisk</a>-compatible
wrapper so that your <code>.bazelversion</code> file is respected. If
<code>.bazelversion</code> is missing, the latest version of Bazel is used. We
always recommend including a <code>.bazelversion</code> in your repo to prevent
problems caused by using conflicting versions of Bazel in different
build environments.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="buildbuddyyaml-schema"></a>buildbuddy.yaml schema<a class="hash-link" href="#buildbuddyyaml-schema" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="buildbuddyconfig"></a><code>BuildBuddyConfig</code><a class="hash-link" href="#buildbuddyconfig" title="Direct link to heading">#</a></h3><p>The top-level BuildBuddy workflow config, which specifies bazel commands
that can be run on a repo, as well as the events that trigger those commands.</p><p><strong>Fields:</strong></p><ul><li><strong><code>actions</code></strong> (<a href="#action"><code>Action</code></a> list): List of actions that can be triggered by BuildBuddy.
Each action corresponds to a separate check on GitHub.
If multiple actions are matched for a given event, the actions are run in
order. If an action fails, subsequent actions will still be executed.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="action"></a><code>Action</code><a class="hash-link" href="#action" title="Direct link to heading">#</a></h3><p>A named group of Bazel commands that run when triggered.</p><p><strong>Fields:</strong></p><ul><li><strong><code>name</code></strong> (<code>string</code>): A name unique to this config, which shows up as the name of the check
in GitHub.</li><li><strong><code>triggers</code></strong> (<a href="#triggers"><code>Triggers</code></a>): The triggers that should cause this action to be run.</li><li><strong><code>bazel_commands</code></strong> (<code>string</code> list): Bazel commands to be run in order.
If a command fails, subsequent ones are not run, and the action is
reported as failed. Otherwise, the action is reported as succeeded.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="triggers"></a><code>Triggers</code><a class="hash-link" href="#triggers" title="Direct link to heading">#</a></h3><p>Defines whether an action should run when a branch is pushed to the repo.</p><p><strong>Fields:</strong></p><ul><li><strong><code>push</code></strong> (<a href="#push-trigger"><code>PushTrigger</code></a>): Configuration for push events associated with the repo.
This is mostly useful for reporting commit statuses that show up on the
home page of the repo.</li><li><strong><code>pull_request</code></strong> (<a href="#pull-request-trigger"><code>PullRequestTrigger</code></a>):
Configuration for pull request events associated with the repo.
This is required if you want to use BuildBuddy to report the status of
this action on pull requests, and optionally prevent pull requests from
being merged if the action fails.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="pushtrigger"></a><code>PushTrigger</code><a class="hash-link" href="#pushtrigger" title="Direct link to heading">#</a></h3><p>Defines whether an action should execute when a branch is pushed.</p><p><strong>Fields:</strong></p><ul><li><strong><code>branches</code></strong> (<code>string</code> list): The branches that, when pushed to, will trigger the action.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="pullrequesttrigger"></a><code>PullRequestTrigger</code><a class="hash-link" href="#pullrequesttrigger" title="Direct link to heading">#</a></h3><p>Defines whether an action should execute when a pull request (PR) branch is
pushed.</p><p><strong>Fields:</strong></p><ul><li><strong><code>branches</code></strong> (<code>string</code> list): The <em>target</em> branches of a pull request.
For example, if this is set to <code>[ &quot;v1&quot;, &quot;v2&quot; ]</code>, then the
associated action is only run when a PR wants to merge a branch <em>into</em>
the <code>v1</code> branch or the <code>v2</code> branch.</li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/buildbuddy-io/buildbuddy/edit/master/docs/../docs/workflows-config.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#example-config" class="table-of-contents__link">Example config</a></li><li><a href="#buildbuddyyaml-schema" class="table-of-contents__link">buildbuddy.yaml schema</a><ul><li><a href="#buildbuddyconfig" class="table-of-contents__link"><code>BuildBuddyConfig</code></a></li><li><a href="#action" class="table-of-contents__link"><code>Action</code></a></li><li><a href="#triggers" class="table-of-contents__link"><code>Triggers</code></a></li><li><a href="#pushtrigger" class="table-of-contents__link"><code>PushTrigger</code></a></li><li><a href="#pullrequesttrigger" class="table-of-contents__link"><code>PullRequestTrigger</code></a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><ul class="footer__items"><li class="footer__item"><a href="https://www.buildbuddy.io/"><img src="/img/logo_white.svg" class="footer-logo"></a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Product</h4><ul class="footer__items"><li class="footer__item"><a href="https://app.buildbuddy.io/" target="_self" rel="noopener noreferrer" class="footer__link-item">Get Started</a></li><li class="footer__item"><a href="https://docs.buildbuddy.io/docs/introduction/" target="_self" rel="noopener noreferrer" class="footer__link-item">Documentation</a></li><li class="footer__item"><a href="https://www.buildbuddy.io/pricing" target="_self" rel="noopener noreferrer" class="footer__link-item">Pricing</a></li><li class="footer__item"><a href="https://app.buildbuddy.io/" target="_self" rel="noopener noreferrer" class="footer__link-item">Login</a></li><li class="footer__item"><a href="https://www.buildbuddy.io/privacy" target="_self" rel="noopener noreferrer" class="footer__link-item">Privacy Policy</a></li><li class="footer__item"><a href="https://www.buildbuddy.io/terms" target="_self" rel="noopener noreferrer" class="footer__link-item">Terms of Service</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Company</h4><ul class="footer__items"><li class="footer__item"><a href="https://blog.buildbuddy.io/blog/" target="_self" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/buildbuddy-io/buildbuddy/issues/new" target="_blank" rel="noopener noreferrer" class="footer__link-item">Report an Issue</a></li><li class="footer__item"><a href="https://www.buildbuddy.io/contact" target="_self" rel="noopener noreferrer" class="footer__link-item">Contact Us</a></li><li class="footer__item"><a href="https://www.buildbuddy.io/team" target="_self" rel="noopener noreferrer" class="footer__link-item">Our Team</a></li><li class="footer__item"><a href="https://www.buildbuddy.io/careers" target="_self" rel="noopener noreferrer" class="footer__link-item">Careers</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Security</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.buildbuddy.io/security" target="_self" rel="noopener noreferrer" class="footer__link-item">Security Overview</a></li><li class="footer__item"><a href="https://www.buildbuddy.io/security-updates" target="_self" rel="noopener noreferrer" class="footer__link-item">Security Updates</a></li><li class="footer__item"><a href="https://www.buildbuddy.io/security-vulnerability-report" target="_self" rel="noopener noreferrer" class="footer__link-item">Report a Vulnerability</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Connect</h4><ul class="footer__items"><li class="footer__item"><a href="http://slack.buildbuddy.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack</a></li><li class="footer__item"><a href="https://twitter.com/buildbuddy_io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="http://linkedin.com/company/buildbuddy" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn</a></li><li class="footer__item"><a href="https://github.com/buildbuddy-io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2021 Iteration, Inc.</div></div></div></footer></div>
<script src="/assets/js/styles.99ff62e2.js"></script>
<script src="/assets/js/runtime~main.fb523e5f.js"></script>
<script src="/assets/js/main.6a7acce9.js"></script>
<script src="/assets/js/1.af4f1695.js"></script>
<script src="/assets/js/2.188d4042.js"></script>
<script src="/assets/js/3.98ab277b.js"></script>
<script src="/assets/js/1be78505.31ec347f.js"></script>
<script src="/assets/js/56.4a323b8d.js"></script>
<script src="/assets/js/935f2afb.52920a53.js"></script>
<script src="/assets/js/17896441.47f4e99e.js"></script>
<script src="/assets/js/95212d9b.0b4173f1.js"></script>
</body>
</html>